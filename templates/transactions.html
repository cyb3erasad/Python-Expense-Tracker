{% extends "base.html" %}

{% block title %}Transactions - Expense Tracker{% endblock %}

{% block content %}
<div class="animate-slide-in">
    <div class="flex justify-between items-center mb-8">
        <h1 class="text-4xl font-bold text-white">Transaction History</h1>
        <a href="{{ url_for('add_transaction') }}" 
           class="btn-gradient px-6 py-3 rounded-lg text-white font-bold shadow-lg hover:shadow-2xl transform hover:scale-105 transition-all duration-300">
            <span>+ Add New</span>
        </a>
    </div>

    {% if transactions %}
    <div class="glass-effect rounded-2xl p-6">
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="border-b border-white/20">
                        <th class="text-left text-white font-bold py-4 px-4">Date</th>
                        <th class="text-left text-white font-bold py-4 px-4">Type</th>
                        <th class="text-left text-white font-bold py-4 px-4">Description</th>
                        <th class="text-right text-white font-bold py-4 px-4">Amount</th>
                        <th class="text-center text-white font-bold py-4 px-4">Action</th>
                    </tr>
                </thead>
                <tbody id="transactionTable">
                    {% for transaction in transactions %}
                    <tr class="border-b border-white/10 hover:bg-white/10 transition-all duration-300 transaction-row" style="animation-delay: {{ loop.index * 0.05 }}s">
                        <td class="py-4 px-4 text-gray-200">
                            {{ transaction.date.strftime('%b %d, %Y') }}
                        </td>
                        <td class="py-4 px-4">
                            {% if transaction.type == 'income' %}
                            <span class="bg-green-500/30 text-green-200 px-3 py-1 rounded-full text-sm font-medium">
                                üí∞ Income
                            </span>
                            {% else %}
                            <span class="bg-red-500/30 text-red-200 px-3 py-1 rounded-full text-sm font-medium">
                                üí∏ Expense
                            </span>
                            {% endif %}
                        </td>
                        <td class="py-4 px-4 text-gray-200">
                            {{ transaction.description }}
                        </td>
                        <td class="py-4 px-4 text-right font-bold {% if transaction.type == 'income' %}text-green-300{% else %}text-red-300{% endif %}">
                            {% if transaction.type == 'income' %}+{% else %}-{% endif %}
                            ‚Ç®{{ "%.2f"|format(transaction.amount) }}
                        </td>
                        <td class="py-4 px-4 text-center">
                            <form method="POST" action="{{ url_for('delete', id=transaction.id) }}" 
                                  onsubmit="return confirm('Are you sure you want to delete this transaction?');"
                                  class="inline-block">
                                <button type="submit" 
                                        class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-medium shadow-md hover:shadow-lg transform hover:scale-110 transition-all duration-300 delete-btn">
                                    üóëÔ∏è Delete
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% else %}
    <div class="glass-effect rounded-2xl p-12 text-center">
        <div class="text-6xl mb-4">üì≠</div>
        <h3 class="text-2xl font-bold text-white mb-2">No Transactions Yet</h3>
        <p class="text-gray-200 mb-6">Start by adding your first transaction</p>
        <a href="{{ url_for('add_transaction') }}" 
           class="btn-gradient inline-block px-8 py-3 rounded-lg text-white font-bold shadow-lg hover:shadow-2xl transform hover:scale-105 transition-all duration-300">
            <span>+ Add Transaction</span>
        </a>
    </div>
    {% endif %}
</div>

<style>
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .transaction-row {
        animation: fadeInUp 0.5s ease forwards;
        opacity: 0;
    }

    .delete-btn {
        position: relative;
        overflow: hidden;
    }

    .delete-btn::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.3);
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
    }

    .delete-btn:hover::before {
        width: 300px;
        height: 300px;
    }
</style>

<script>
    // Add smooth scroll animation for table rows
    const rows = document.querySelectorAll('.transaction-row');
    rows.forEach((row, index) => {
        setTimeout(() => {
            row.style.opacity = '1';
        }, index * 50);
    });

    // Add hover effect with scale
    rows.forEach(row => {
        row.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.01)';
            this.style.transition = 'all 0.3s ease';
        });
        
        row.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
        });
    });

    // Add ripple effect on delete button click
    document.querySelectorAll('.delete-btn').forEach(button => {
        button.addEventListener('click', function(e) {
            const ripple = document.createElement('span');
            const rect = this.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = e.clientX - rect.left - size / 2;
            const y = e.clientY - rect.top - size / 2;
            
            ripple.style.width = ripple.style.height = size + 'px';
            ripple.style.left = x + 'px';
            ripple.style.top = y + 'px';
            ripple.classList.add('ripple');
            
            this.appendChild(ripple);
            
            setTimeout(() => ripple.remove(), 600);
        });
    });
</script>
{% endblock %}